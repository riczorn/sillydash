# Silly Dash

A lightweight dashboard to view Virtualmin accounts and monitoring disk usage.
It provides a clean interface to visualize account data; includes installation instructions.
Configurable via web or editing `config.php`, it runs on a webserver and connects to a MariaDB database.

![Dashboard](/docs/5.%20Dashboard.png)

## Installation
Clone this repo anywhere on your server; then go there in the browser to start the setup.

Example:

```bash
cd /home/example.com/public_html
git clone https://github.com/riczorn/sillydash.git
``` 
Then go to http://example.com/sillydash to start the setup.

### Configure nginx
If you run nginx, and you host the project in a subfolder of the web root, you will need to configure the default handler (index.php) for the location where you choose to install. If the folder is called silldash, handle it just before you php handler. It could look like this - make sure to update `fastcgi_pass` to match your setup.
```
location ^~ /silldash {
    root /home/example.com/public_html;
    index index.php index.html;
    try_files $uri $uri/ /silldash/index.php?$args;
    location ~ \.php {
        include fastcgi_params;
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_pass unix:/run/php-fpm/php-fpm.sock;
        # Explicitly set SCRIPT_FILENAME to the correct full path
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
    }
}
location ~ \.php(?:$|/) {
...
```

Note: if you run Apache instead, the .htaccess should take care of the routing.


### 1. Setup
Initial configuration: folders, database, user creation.

![Setup](/docs/1.%20Setup.png)


### 2. Database Connection
The setup tests the database connection before saving the configuration, to improve chances of it actually working.

![Error Cannot connect to db](/docs/2.%20Error%20Cannot%20connect%20to%20db.png)

### 3. Config File
If the setup cannot write the `config.php` file - presumably for permission issues - no problem: it will display the file contents for you to manually save to `config.php`.

![Config file](/docs/3.%20Config%20file.png)

## Login

Use the login button in the top right. 

![Login](/docs/4.%20Login.png)

## Dashboard and accounts

### Dashboard View
View Virtualmin accounts, mail, db and log size over time

![Dashboard](/docs/5.%20Dashboard.png)

Below it, a pie chart to represent the largest accounts:

![Dashboard Piechart](/docs/5b.%20Dashboard.png)

### Subdomains
View ongoing usage for subdomains under this account

![Subdomains](/docs/6.%20Subdomains.png)

![Subdomains 40+ subservers](/docs/6b.%20Subdomains.png)

### Disk Usage Trends
Analyze disk usage trends

![Disk Usage Trends](/docs/7.%20Disk%20Usage%20Trends.png)

### Accounts
List all hosting accounts and their domains

![Accounts](/docs/8.%20Accounts.png)

## Configuration

### Users Management
List and create users.

![Users list](/docs/9.%20Users%20list.png)

### Edit User
Edit user profiles. Supports two roles: admin (visibility: all accounts) and user (choose the accounts they can see)

![Edit User](/docs/10.%20Edit%20User.png)


### Settings
Configure general application settings.
        
![Settings](/docs/11.%20Settings.png)






## Scripts

The .list files that this application expects are generated by the scripts in the folder scripts.

*   **brutal_virtualmin_accounts_list.sh**: wrapper to list domains and call the per-domain script.
*   **mail_size.sh**: calculates mail directory sizes.
*   **size_sites.sh**: calculates sizes for sites, db, logs, etc.

`size_sites.sh` and `mail_size.sh` should be scheduled weekly or daily; you only need to run `brutal_virtualmin_accounts_list.sh` when you add or remove accounts.

